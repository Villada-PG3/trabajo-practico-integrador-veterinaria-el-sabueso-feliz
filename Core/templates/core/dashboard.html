{% extends "core/header.html" %}
{% load static %}

{% block title %}Panel - Sabueso Feliz{% endblock %}

{% block extra_head %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block main_class %}max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10{% endblock %}

{% block content %}
<div class="dashboard-shell">
    {% if request.user.rol == "ADMIN" %}
    <section class="section-card admin-hero text-white">
        <div class="grid gap-8 lg:grid-cols-2">
            <div>
                <p class="text-xs font-semibold uppercase tracking-[0.35em] text-white/70">Direccion general</p>
                <h2 class="mt-4 text-3xl font-bold leading-tight sm:text-4xl">Panel de Administracion</h2>
                <p class="mt-3 text-sm text-white/80 sm:text-base">
                    Monitorea operaciones, formularios y reportes desde bloques independientes para mantener todo claro y accesible.
                </p>
    
                <!-- BOTONES ESENCIALES ADMIN -->
                <div class="mt-6 flex flex-wrap gap-3 text-sm font-semibold">
    
                    <a href="{% url 'crear_propietario_admin' %}"
                       class="hero-pill flex items-center gap-2 bg-emerald-500/20 border border-emerald-400/40 hover:bg-emerald-500/30">
                        <i class="bi bi-person-plus"></i>
                        Crear propietario
                    </a>
    
                    <a href="{% url 'crear_mascota_admin' %}"
                       class="hero-pill flex items-center gap-2 bg-blue-500/20 border border-blue-400/40 hover:bg-blue-500/30">
                        <i class="bi bi-paw"></i>
                        Crear mascota
                    </a>
    
                    <a href="{% url 'agendar_cita_admin' %}"
                       class="hero-pill flex items-center gap-2 bg-amber-400/20 border border-amber-300/40 hover:bg-amber-400/30">
                        <i class="bi bi-calendar-plus"></i>
                        Agendar cita
                    </a>
    
                </div>
            </div>
    
            <div class="rounded-2xl bg-white/15 p-6 shadow-lg backdrop-blur">
                <p class="text-xs font-semibold uppercase tracking-[0.3em] text-white/70">Checklist diario</p>
                <ul class="mt-5 space-y-4 text-sm text-white/85">
    
                    <li class="flex items-start gap-3">
                        <span class="mt-1 h-2.5 w-2.5 rounded-full bg-emerald-300"></span>
                        <div>
                            <p class="font-semibold">Validar nuevas altas</p>
                            <p class="text-white/70">Propietarios y pacientes creados desde formularios web o presencial.</p>
                        </div>
                    </li>
    
                    <li class="flex items-start gap-3">
                        <span class="mt-1 h-2.5 w-2.5 rounded-full bg-amber-300"></span>
                        <div>
                            <p class="font-semibold">Revisar agenda central</p>
                            <p class="text-white/70">Confirma citas asignadas y libera huecos cancelados.</p>
                        </div>
                    </li>
    
                    <li class="flex items-start gap-3">
                        <span class="mt-1 h-2.5 w-2.5 rounded-full bg-sky-300"></span>
                        <div>
                            <p class="font-semibold">Sincronizar inventario</p>
                            <p class="text-white/70">Actualiza farmacos y productos antes de abrir la tienda.</p>
                        </div>
                    </li>
    
                </ul>
            </div>
        </div>
    </section>
    
    <section class="section-card">
        <div class="section-header">
            <p class="section-eyebrow">Formularios en tarjetas</p>
            <h3>Busquedas contextuales</h3>
            <p class="section-description">Selecciona el tipo de ficha a revisar mediante tarjetas, evitando menus desplegables.</p>
        </div>
    
        <div class="grid gap-6">
            <div class="rounded-2xl border border-slate-200 bg-slate-50 p-4">
                <h4 class="text-lg font-semibold text-slate-900">Buscador centralizado</h4>
                <p class="mb-3 text-sm text-slate-600">
                    Define el enfoque desde tarjetas y luego ingresa el criterio deseado.
                </p>
    
                {% with scope=request.GET.scope|default:"propietarios" %}
                <form method="get" action="{% url 'buscar_propietarios' %}" class="space-y-4">
    
                    <div class="grid gap-3 sm:grid-cols-3">
                        <div class="relative">
                            <input type="radio" name="scope" id="scope_propietarios" value="propietarios"
                                   class="form-option-input" {% if scope == "propietarios" %}checked{% endif %}>
                            <label for="scope_propietarios" class="form-option-card flex flex-col justify-center">
                                <p class="form-option-card__title">Propietarios</p>
                                <p class="form-option-card__desc">Contactos y datos completos.</p>
                            </label>
                        </div>
                    
                        <div class="relative">
                            <input type="radio" name="scope" id="scope_pacientes" value="pacientes"
                                   class="form-option-input" {% if scope == "pacientes" %}checked{% endif %}>
                            <label for="scope_pacientes" class="form-option-card flex flex-col justify-center">
                                <p class="form-option-card__title">Pacientes</p>
                                <p class="form-option-card__desc">Mascotas vinculadas y fichas.</p>
                            </label>
                        </div>
                    
                        <div class="relative">
                            <input type="radio" name="scope" id="scope_citas" value="citas"
                                   class="form-option-input" {% if scope == "citas" %}checked{% endif %}>
                            <label for="scope_citas" class="form-option-card flex flex-col justify-center">
                                <p class="form-option-card__title">Citas</p>
                                <p class="form-option-card__desc">Turnos confirmados o pendientes.</p>
                            </label>
                        </div>
                    </div>
                    
                    <div class="flex flex-col gap-3 sm:flex-row">
                        <input type="text"
                               name="q"
                               placeholder="Nombre, telefono o email"
                               value="{{ request.GET.q }}"
                               class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm
                                      focus:border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500">
    
                        <button type="submit"
                                class="inline-flex items-center justify-center rounded-xl bg-blue-600
                                       px-5 py-2 text-sm font-semibold text-white shadow hover:bg-blue-700">
                            <i class="fas fa-search mr-2"></i>
                            Buscar registro
                        </button>
                    </div>
    
                </form>
                {% endwith %}
            </div>
        </div>
    </section>
    

    
    <section class="section-card">
            <div class="section-header">
                <p class="section-eyebrow">Modulos funcionales</p>
                <h3>Gestion</h3>
            <div class="functional-grid">
                <article class="functional-card">
                    <div class="functional-card__icon bg-blue-50 text-blue-600">
                        <i class="fas fa-id-card"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-semibold text-slate-900">Clientes y pacientes</h4>
                        <p class="text-sm text-slate-600">Crea o edita informacion base directamente desde estas tarjetas dedicadas.</p>
                    </div>
                    <div class="functional-card__actions">
                        <a href="{% url 'crear_propietario_admin' %}">
                            <i class="fas fa-user-plus"></i>
                            Nuevo propietario
                        </a>
                        <a href="{% url 'crear_mascota_admin' %}">
                            <i class="fas fa-paw"></i>
                            Nueva mascota
                        </a>
                        <a href="{% url 'buscar_propietarios' %}">
                            <i class="fas fa-search"></i>
                            Buscar fichas
                        </a>
                    </div>
                </article>
                <article class="functional-card">
                    <div class="functional-card__icon bg-purple-50 text-purple-600">
                        <i class="fas fa-calendar-plus"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-semibold text-slate-900">Agenda y equipo medico</h4>
                        <p class="text-sm text-slate-600">Administra turnos y asignaciones desde acciones separadas e intuitivas.</p>
                    </div>
                    <div class="functional-card__actions">
                        <a href="{% url 'agendar_cita_admin' %}">
                            <i class="fas fa-calendar-check"></i>
                            Agendar cita
                        </a>
                        <a href="{% url 'asignar_veterinario_citas' %}">
                            <i class="fas fa-user-md"></i>
                            Asignar veterinarios
                        </a>
                        <a href="{% url 'gestionar_veterinarios' %}">
                            <i class="fas fa-user-clock"></i>
                            Nuevos veterinarios
                        </a>
                        <a href="{% url 'dashboard_veterinarios' %}">
                            <i class="fas fa-chart-bar"></i>
                            Stats veterinarios
                        </a>
                    </div>
                </article>
                <article class="functional-card">
                    <div class="functional-card__icon bg-emerald-50 text-emerald-600">
                        <i class="fas fa-boxes"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-semibold text-slate-900">Inventario y negocio</h4>
                        <p class="text-sm text-slate-600">Controla recursos, reportes y tienda oficial sin perder contexto.</p>
                    </div>
                    <div class="functional-card__actions">
                        <a href="{% url 'inventario_farmacos_admin' %}">
                            <i class="fas fa-prescription-bottle-medical"></i>
                            Farmacos
                        </a>
                        <a href="{% url 'dashboard_admin_analisis' %}">
                            <i class="fas fa-chart-line"></i>
                            Analitica
                        </a>
                        <a href="{% url 'admin_productos_list' %}">
                            <i class="fas fa-store"></i>
                            Gestionar tienda
                        </a>
                    </div>
                </article>
            </div>
        </section>


        {% if productos_recientes %}
        <section class="section-card">
            <div class="section-header">
                <p class="section-eyebrow">Tienda</p>
                <h3>Ultimos productos aprobados</h3>
                <p class="section-description">Valida disponibilidad y estado comercial antes de publicarlos.</p>
            </div>
            <div class="grid grid-cols-1 gap-4">
                {% for producto in productos_recientes %}
                    <article class="flex flex-col gap-4 rounded-2xl border border-slate-200 bg-white p-4 lg:flex-row lg:items-center">
                        <div class="flex flex-1 items-center gap-4">
                            {% if producto.imagen %}
                                <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}" class="h-20 w-20 rounded-xl object-cover">
                            {% else %}
                                <div class="flex h-20 w-20 items-center justify-center rounded-xl bg-slate-100 text-slate-400">
                                    <i class="fas fa-box text-xl"></i>
                                </div>
                            {% endif %}
                            <div>
                                <h4 class="text-base font-semibold text-slate-900">{{ producto.nombre }}</h4>
                                <p class="text-xs uppercase tracking-wider text-slate-500">{{ producto.get_categoria_display }}</p>
                                <p class="text-xs text-slate-500">Actualizado {{ producto.actualizado|date:"d/m/Y H:i" }}</p>
                            </div>
                        </div>
                        <div class="flex flex-wrap items-center justify-between gap-3 lg:flex-none">
                            <span class="text-lg font-bold text-slate-900">${{ producto.precio }}</span>
                            <span class="status-badge {% if producto.disponible %}bg-emerald-100 text-emerald-700{% else %}bg-rose-100 text-rose-700{% endif %}">
                                {% if producto.disponible %}Publicado{% else %}No visible{% endif %}
                            </span>
                            <a href="{% url 'admin_producto_editar' producto.id %}" class="text-sm font-semibold text-blue-600 hover:text-blue-800">
                                Editar
                            </a>
                        </div>
                    </article>
                {% endfor %}
            </div>
        </section>
        {% endif %}
    {% elif request.user.rol == "VET" %}
            <div class="space-y-10">
                <section class="relative overflow-hidden rounded-3xl text-white shadow-xl" style="background: linear-gradient(125deg, #0f172a 0%, #142850 55%, #1f3b72 110%);">
                    <div class="pointer-events-none absolute inset-0 opacity-60" style="background-image: radial-gradient(circle at 15% 25%, rgba(255,255,255,0.35) 0, transparent 50%), radial-gradient(circle at 85% 5%, rgba(122,58,255,0.45) 0, transparent 45%);"></div>
                    <div class="relative z-10 px-6 py-10 sm:px-10">
                        <div class="grid items-start gap-10 lg:grid-cols-[minmax(0,3fr),minmax(0,2fr)]">
                            <div>
                                <p class="text-xs font-semibold uppercase tracking-[0.35em] text-white/70">Panel clínico</p>
                                <h2 class="mt-3 text-3xl font-bold sm:text-4xl">Hola, {{ request.user.get_full_name|default:request.user.username }}</h2>
                                <p class="mt-4 text-sm text-white/80 sm:text-base">Gestion turnos, seguimientos y comunicaciones con tutores desde un espacio alineado a la identidad de Sabueso Feliz.</p>
                                <div class="mt-6 grid gap-4 sm:grid-cols-3">
                                    <div class="rounded-2xl bg-white/15 p-4 shadow-sm backdrop-blur">
                                        <p class="text-xs uppercase tracking-widest text-white/70">Citas activas</p>
                                        <p class="mt-2 text-2xl font-semibold">{{ mis_citas|length }}</p>
                                        <p class="text-xs text-white/75">Turnos asignados</p>
                                    </div>
                                    <div class="rounded-2xl bg-white/15 p-4 shadow-sm backdrop-blur">
                                        <p class="text-xs uppercase tracking-widest text-white/70">Historias</p>
                                        <p class="mt-2 text-2xl font-semibold">{{ mis_historiales|length }}</p>
                                        <p class="text-xs text-white/75">ultimos registros</p>
                                    </div>
                                    <div class="rounded-2xl bg-white/15 p-4 shadow-sm backdrop-blur">
                                        <p class="text-xs uppercase tracking-widest text-white/70">Actividad</p>
                                        <p class="mt-2 text-2xl font-semibold">{{ citas_recientes|length }}</p>
                                        <p class="text-xs text-white/75">Movimientos recientes</p>
                                    </div>
                                </div>
                            </div>
                            <div class="rounded-2xl bg-white/15 p-6 shadow-2xl backdrop-blur">
                                {% if mi_sucursal %}
                                    <p class="text-xs font-semibold uppercase tracking-widest text-white/70">Sucursal asignada</p>
                                    <h3 class="mt-3 text-2xl font-bold text-white">{{ mi_sucursal.nombre }}</h3>
                                    {% if mi_sucursal.direccion %}
                                        <p class="mt-2 text-sm text-white/80">
                                            {{ mi_sucursal.direccion }}
                                            {% if mi_sucursal.ciudad %}
                                                · {{ mi_sucursal.ciudad }}
                                            {% endif %}
                                        </p>
                                    {% endif %}
                                    {% if mi_sucursal.telefono %}
                                        <a href="tel:{{ mi_sucursal.telefono }}" class="mt-5 inline-flex items-center gap-2 rounded-2xl bg-white px-4 py-2 text-sm font-semibold text-[#1f3b72] shadow hover:bg-white/90">
                                            <i class="fas fa-phone"></i>
                                            {{ mi_sucursal.telefono }}
                                        </a>
                                    {% endif %}
                                {% else %}
                                    <p class="text-xs font-semibold uppercase tracking-widest text-white/70">Sin sucursal</p>
                                    <h3 class="mt-3 text-2xl font-bold">Aun no estas asignado</h3>
                                    <p class="mt-2 text-sm text-white/80">Contactar al equipo administrativo para vincular tu perfil a la sede correspondiente.</p>
                                    <a href="mailto:administracion@sabuesofeliz.com" class="mt-5 inline-flex items-center gap-2 rounded-2xl border border-white/40 px-4 py-2 text-sm font-semibold text-white hover:bg-white/10">
                                        <i class="fas fa-envelope"></i>
                                        Escribir a soporte
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </section>

                <div class="grid gap-8 lg:grid-cols-3">
                    <div class="space-y-6 lg:col-span-2">
                        <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                            <div class="flex flex-wrap items-start justify-between gap-4">
                                <div>
                                    <h3 class="text-lg font-semibold text-[#0f172a]">Agenda inmediata</h3>
                                    <p class="text-sm text-[#536189]">Proximos pacientes confirmados</p>
                                </div>
                                <a href="{% url 'mis_citas' %}" class="inline-flex items-center gap-2 text-sm font-semibold text-[#7A3AFF] hover:text-[#6140ff]">
                                    <i class="fas fa-calendar-alt"></i>
                                    Ver agenda completa
                                </a>
                            </div>
                            <div class="mt-5 space-y-4">
                                {% for cita in mis_citas %}
                                    <div class="rounded-2xl border border-[#e9ebf7] p-5 shadow-sm transition-all hover:border-[#c7b8ff] hover:bg-[#f7f4ff]">
                                        <div class="flex flex-wrap items-start justify-between gap-4">
                                            <div class="space-y-2">
                                                <div class="flex flex-wrap items-center gap-2 text-base font-semibold text-[#0f172a]">
                                                    <i class="fas fa-paw text-[#7A3AFF]"></i>
                                                    {{ cita.paciente.nombre }}
                                                    <span class="text-sm font-normal text-[#647093]">({{ cita.paciente.especie }})</span>
                                                </div>
                                                <p class="flex items-center gap-2 text-sm text-[#4c587a]">
                                                    <i class="fas fa-clock text-[#9ca4c8]"></i>
                                                    {% if cita.fecha_hora %}
                                                        {{ cita.fecha_hora|date:"d/m/Y · H:i" }} hs
                                                    {% else %}
                                                        {{ cita.fecha_solicitada|date:"d/m/Y" }}  Horario a coordinar
                                                    {% endif %}
                                                </p>
                                                <p class="flex items-center gap-2 text-sm text-[#4c587a]">
                                                    <i class="fas fa-user text-[#9ca4c8]"></i>
                                                    {% if cita.paciente.propietario %}
                                                        {{ cita.paciente.propietario.user.get_full_name }}
                                                        {% if cita.paciente.propietario.telefono %}
                                                            Tel. {{ cita.paciente.propietario.telefono }}
                                                        {% endif %}
                                                    {% else %}
                                                        Sin propietario registrado
                                                    {% endif %}
                                                </p>
                                            </div>
                                            <div class="flex flex-col items-end gap-2">
                                                <span class="status-badge {% if cita.estado == 'programada' %}bg-[#E7E9FF] text-[#1f3b72]{% elif cita.estado == 'atendida' %}bg-[#E6FFF4] text-[#047857]{% elif cita.estado == 'cancelada' %}bg-[#FFE8E8] text-[#B42318]{% else %}bg-[#F4F3F9] text-[#4b3b91]{% endif %}">
                                                    {{ cita.get_estado_display|default:cita.estado }}
                                                </span>
                                                {% if cita.estado == "programada" %}
                                                    <a href="{% url 'atender_cita' cita.id %}" class="inline-flex items-center gap-2 rounded-xl bg-[#7A3AFF] px-3 py-2 text-xs font-semibold text-white shadow hover:bg-[#5c25d7]">
                                                        <i class="fas fa-stethoscope"></i>
                                                        Atender
                                                    </a>
                                                {% endif %}
                                            </div>
                                        </div>
                                        {% if cita.paciente.propietario and cita.paciente.propietario.telefono %}
                                            <div class="mt-4 rounded-2xl bg-[#F4F3F9] px-4 py-3 text-sm text-[#4b3b91]">
                                                <div class="flex flex-wrap items-center gap-3">
                                                    <i class="fab fa-whatsapp text-[#25D366]"></i>
                                                    <span class="text-xs font-semibold uppercase tracking-widest">Atajos de contacto</span>
                                                    <div class="flex flex-wrap gap-2 text-xs font-semibold">
                                                        <a class="inline-flex items-center gap-1 rounded-full bg-white px-3 py-1 text-[#1f3b72] shadow" href="https://wa.me/{{ cita.paciente.propietario.telefono }}?text=Hola%20{{ cita.paciente.propietario.user.get_full_name|urlencode }},%20{{ cita.paciente.nombre|urlencode }}%20ya%20te%20espera%20en%20Sabueso%20Feliz." target="_blank">Actualizar</a>
                                                        <a class="inline-flex items-center gap-1 rounded-full bg-white px-3 py-1 text-[#1f3b72] shadow" href="https://wa.me/{{ cita.paciente.propietario.telefono }}?text=Hola%20{{ cita.paciente.propietario.user.get_full_name|urlencode }},%20recordatorio%20de%20la%20cita%20de%20{{ cita.paciente.nombre|urlencode }}." target="_blank">Recordar</a>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endif %}
                                    </div>
                                {% empty %}
                                    <div class="rounded-2xl border border-dashed border-[#d6dbf0] bg-[#f8f9ff] p-8 text-center text-[#68719b]">
                                        <i class="fas fa-calendar text-3xl"></i>
                                        <p class="mt-3 text-sm">Aún no tenés citas asignadas.</p>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-[#0f172a]">Historias recientes</h3>
                                    <p class="text-sm text-[#536189]">Últimos diagnósticos cargados</p>
                                </div>
                                <a href="{% url 'mis_citas' %}#historiales" class="text-sm font-semibold text-[#7A3AFF] hover:text-[#6140ff]">Revisar historial</a>
                            </div>
                            <div class="mt-5 space-y-4">
                                {% for hist in mis_historiales %}
                                    <div class="rounded-2xl border border-[#e9ebf7] p-4 transition-all hover:border-[#c7b8ff] hover:bg-[#f7f4ff]">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center gap-3">
                                                <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-[#ede9ff] text-sm font-semibold text-[#4330a0]">{{ hist.paciente.nombre|slice:":2"|upper }}</span>
                                                <div>
                                                    <p class="font-semibold text-[#0f172a]">{{ hist.paciente.nombre }}</p>
                                                    <p class="text-xs text-[#7c87b3]">{{ hist.fecha|date:"d/m/Y" }}</p>
                                                </div>
                                            </div>
                                            <a href="{% url 'detalle_mascota' hist.paciente.id %}" class="text-xs font-semibold text-[#7A3AFF] hover:text-[#6140ff]">Ver ficha</a>
                                        </div>
                                        <p class="mt-3 text-sm text-[#4c587a]">{{ hist.diagnostico|truncatechars:90 }}</p>
                                    </div>
                                {% empty %}
                                    <div class="rounded-2xl border border-dashed border-[#d6dbf0] bg-[#f8f9ff] p-8 text-center text-[#68719b]">
                                        <i class="fas fa-file-medical text-3xl"></i>
                                        <p class="mt-3 text-sm">Los informes cargados aparecerán aquí.</p>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-[#0f172a]">Actividad reciente</h3>
                                    <p class="text-sm text-[#536189]">Últimas citas y cambios</p>
                                </div>
                                <a href="{% url 'mis_citas' %}" class="text-sm font-semibold text-[#7A3AFF] hover:text-[#6140ff]">Ver todo</a>
                            </div>
                            <div class="mt-5 space-y-4">
                                {% for cita in citas_recientes %}
                                    <div class="rounded-2xl border border-[#e9ebf7] p-4">
                                        <div class="flex items-center justify-between gap-3">
                                            <div>
                                                <p class="font-semibold text-[#0f172a]">{{ cita.paciente.nombre }}</p>
                                                <p class="text-xs text-[#7c87b3]">
                                                    {% if cita.fecha_hora %}
                                                        {{ cita.fecha_hora|date:"d/m/Y H:i" }} hs
                                                    {% else %}
                                                        {{ cita.fecha_solicitada|date:"d/m/Y" }}  · Horario pendiente
                                                    {% endif %}
                                                </p>
                                            </div>
                                            <span class="status-badge {% if cita.estado == 'atendida' %}bg-[#E6FFF4] text-[#047857]{% elif cita.estado == 'cancelada' %}bg-[#FFE8E8] text-[#B42318]{% else %}bg-[#E7E9FF] text-[#1f3b72]{% endif %}">
                                                {{ cita.get_estado_display }}
                                            </span>
                                        </div>
                                        <div class="mt-3 flex flex-wrap items-center gap-4 text-xs text-[#5f6b8e]">
                                            <span class="inline-flex items-center gap-1">
                                                <i class="fas fa-user-md text-[#a0a8cc]"></i>
                                                {% if cita.veterinario %}
                                                    {{ cita.veterinario.get_full_name|default:cita.veterinario.username }}
                                                {% else %}
                                                    Veterinario por asignar
                                                {% endif %}
                                            </span>
                                            <span class="inline-flex items-center gap-1">
                                                <i class="fas fa-paw text-[#a0a8cc]"></i>
                                                {{ cita.paciente.especie }}
                                            </span>
                                        </div>
                                        <div class="mt-3 flex flex-wrap gap-2 text-xs font-semibold">
                                            <a href="{% url 'detalle_cita' cita.id %}" class="inline-flex items-center gap-2 rounded-full bg-[#EEF0FF] px-3 py-1 text-[#1f3b72] hover:bg-[#e0e4ff]">
                                                <i class="fas fa-eye"></i>
                                                Ver cita
                                            </a>
                                            {% if cita.estado == 'atendida' %}
                                                <a href="{% url 'detalle_mascota' cita.paciente.id %}" class="inline-flex items-center gap-2 rounded-full border border-[#c7b8ff] px-3 py-1 text-[#7A3AFF] hover:bg-[#f7f4ff]">
                                                    <i class="fas fa-file-medical"></i>
                                                    Informe
                                                </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% empty %}
                                    <div class="rounded-2xl border border-dashed border-[#d6dbf0] bg-[#f8f9ff] p-8 text-center text-[#68719b]">
                                        <i class="fas fa-clipboard-list text-3xl"></i>
                                        <p class="mt-3 text-sm">Cuando atiendas turnos verás sus resúmenes aquí.</p>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>

                        {% if productos_sugeridos %}
                        <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="text-lg font-semibold text-[#0f172a]">Recomendados</h3>
                                    <p class="text-sm text-[#536189]">Para sugerir en consulta</p>
                                </div>
                                <a href="{% url 'tienda' %}" class="text-sm font-semibold text-[#7A3AFF] hover:text-[#6140ff]">Ver tienda</a>
                            </div>
                            <div class="mt-5 space-y-4">
                                {% for producto in productos_sugeridos %}
                                    <a href="{% url 'detalle_producto' producto.id %}" class="flex items-center gap-4 rounded-2xl border border-[#e9ebf7] p-4 transition-all hover:border-[#c7b8ff] hover:bg-[#f7f4ff]">
                                        <div class="h-14 w-14 overflow-hidden rounded-xl bg-[#f0f1fb]">
                                            {% if producto.imagen %}
                                                <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}" class="h-full w-full object-cover">
                                            {% else %}
                                                <div class="flex h-full w-full items-center justify-center text-[#b7c0e0]">
                                                    <i class="fas fa-box"></i>
                                                </div>
                                            {% endif %}
                                        </div>
                                        <div class="flex-1">
                                            <p class="font-semibold text-[#0f172a]">{{ producto.nombre }}</p>
                                            <p class="text-xs text-[#7c87b3]">{{ producto.get_categoria_display }}</p>
                                        </div>
                                        <span class="text-sm font-semibold text-[#1f3b72]">${{ producto.precio }}</span>
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% elif request.user.rol == "OWNER" %}
            {% if propietario_incompleto %}
                <div class="rounded-3xl border border-amber-100 bg-amber-50/80 p-8 text-amber-900 shadow-sm">
                    <h2 class="text-2xl font-semibold">Tus datos aún no están registrados</h2>
                    <p class="mt-3 max-w-2xl text-sm">
                        Para habilitar todas las funciones del panel necesitamos que el equipo administrativo complete tu ficha de propietario. Comunicate con recepción para confirmar tus datos o espera a que la clínica finalice el registro.
                    </p>
                    <div class="mt-6 flex flex-wrap gap-3">
                        <a href="{% url 'landing' %}" class="inline-flex items-center gap-2 rounded-2xl bg-[#7A3AFF] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#5c25d7]">
                            <i class="fas fa-home"></i>
                            Volver al inicio
                        </a>
                        <a href="mailto:administracion@sabuesofeliz.com" class="inline-flex items-center gap-2 rounded-2xl border border-amber-200 px-4 py-2 text-sm font-semibold text-amber-800 hover:bg-amber-100">
                            <i class="fas fa-envelope"></i>
                            Contactar administración
                        </a>
                    </div>
                </div>
            {% else %}
            <div class="space-y-10">
                <section class="relative overflow-hidden rounded-3xl text-white shadow-xl" style="background: linear-gradient(120deg, #0f172a 0%, #142850 55%, #1f3b72 110%);">
                    <div class="pointer-events-none absolute inset-0 opacity-55" style="background-image: radial-gradient(circle at 20% 20%, rgba(255,255,255,0.35) 0, transparent 55%), radial-gradient(circle at 80% 0%, rgba(122,58,255,0.4) 0, transparent 40%);"></div>
                    <div class="relative z-10 px-6 py-10 sm:px-10">
                        <div class="grid items-start gap-10 lg:grid-cols-[minmax(0,1.4fr),minmax(0,360px)]">
                            <div>
                                <p class="text-xs font-semibold uppercase tracking-[0.35em] text-white/70">Panel del propietario</p>
                                <h2 class="mt-3 text-3xl font-bold sm:text-4xl">Hola, {{ request.user.get_full_name|default:request.user.username }}</h2>
                                <p class="mt-4 text-base text-white/80">Gestioná vacunas, turnos y recomendaciones desde un tablero premium alineado a la identidad de Sabueso Feliz.</p>
                                <div class="mt-6 flex flex-wrap gap-3">
                                    <a href="{% url 'calendario_vacunas' %}" class="inline-flex items-center gap-2 rounded-2xl border border-white/40 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/10">
                                        <i class="fas fa-syringe"></i>
                                        Calendario de vacunas
                                    </a>
                                    <a href="{% url 'registrar_mascota' %}" class="inline-flex items-center gap-2 rounded-2xl border border-white/40 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/10">
                                        <i class="fas fa-paw"></i>
                                        Registrar mascota
                                    </a>
                                </div>
                                <div class="mt-8 grid gap-4 sm:grid-cols-3">
                                    <div class="rounded-2xl bg-white/15 p-4 shadow-sm backdrop-blur">
                                        <p class="text-xs uppercase tracking-widest text-white/70">Mascotas activas</p>
                                        <p class="mt-2 text-2xl font-semibold">{{ mis_mascotas|length }}</p>
                                        <p class="text-xs text-white/80">Perfiles registrados</p>
                                    </div>
                                    <div class="rounded-2xl bg-white/15 p-4 shadow-sm backdrop-blur">
                                        <p class="text-xs uppercase tracking-widest text-white/70">Próximas citas</p>
                                        <p class="mt-2 text-2xl font-semibold">{{ citas_proximas|length }}</p>
                                        <p class="text-xs text-white/80">Turnos confirmados</p>
                                    </div>
                                    <div class="rounded-2xl bg-white/15 p-4 shadow-sm backdrop-blur">
                                        <p class="text-xs uppercase tracking-widest text-white/70">Informes recientes</p>
                                        <p class="mt-2 text-2xl font-semibold">{{ historiales_recientes|length }}</p>
                                        <p class="text-xs text-white/80">Últimas atenciones</p>
                                    </div>
                                </div>
                            </div>
                            <div class="rounded-2xl bg-white/15 p-6 shadow-lg backdrop-blur">
                                {% if proxima_cita %}
                                    <p class="text-xs font-semibold uppercase tracking-widest text-white/70">Próxima cita</p>
                                    <h3 class="mt-3 text-2xl font-bold">{{ proxima_cita.paciente.nombre }}</h3>
                                    <p class="mt-2 flex items-center gap-2 text-sm text-white/85">
                                        <i class="fas fa-clock"></i>
                                        {{ proxima_cita.fecha_hora|date:"d \d\e F, H:i" }} hs
                                    </p>
                                    <p class="mt-1 flex items-center gap-2 text-sm text-white/85">
                                        <i class="fas fa-user-md"></i>
                                        {% if proxima_cita.veterinario %}
                                            {{ proxima_cita.veterinario.get_full_name|default:proxima_cita.veterinario.username }}
                                        {% else %}
                                            A confirmar por la clínica
                                        {% endif %}
                                    </p>
                                    <div class="mt-5 flex flex-wrap gap-2">
                                        <a href="{% url 'detalle_cita' proxima_cita.id %}" class="inline-flex items-center gap-2 rounded-2xl bg-white px-4 py-2 text-xs font-semibold text-[#1f3b72] shadow hover:bg-white/90">
                                            <i class="fas fa-eye"></i>
                                            Ver detalle
                                        </a>
                                        <a href="{% url 'detalle_mascota' proxima_cita.paciente.id %}" class="inline-flex items-center gap-2 rounded-2xl border border-white/50 px-4 py-2 text-xs font-semibold text-white hover:bg-white/10">
                                            <i class="fas fa-notes-medical"></i>
                                            Historia clínica
                                        </a>
                                    </div>
                                {% else %}
                                    <p class="text-xs font-semibold uppercase tracking-widest text-white/70">Sin turnos próximos</p>
                                    <h3 class="mt-3 text-2xl font-bold">Agenda el próximo control</h3>
                                    <p class="mt-2 text-sm text-white/80">Reservá tu siguiente visita para mantener al día los cuidados.</p>
                                    <a href="{% url 'agendar_cita' %}" class="mt-5 inline-flex items-center gap-2 rounded-2xl bg-white px-4 py-2 text-sm font-semibold text-[#1f3b72] shadow hover:bg-white/90">
                                        <i class="fas fa-calendar-check"></i>
                                        Reservar cita
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </section>

                <div class="grid grid-cols-1 gap-8 lg:grid-cols-3">
                    <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                        <div class="flex items-start justify-between">
                            <div>
                                <h3 class="text-lg font-semibold text-[#0f172a]">Mis mascotas</h3>
                                <p class="text-sm text-[#536189]">Acceso rápido a cada perfil</p>
                            </div>
                            <a href="{% url 'registrar_mascota' %}" class="inline-flex items-center gap-2 rounded-2xl bg-[#F4F3F9] px-3 py-1 text-xs font-semibold text-[#7A3AFF] hover:bg-[#ebe7ff]">
                                <i class="fas fa-plus"></i>
                                Nueva mascota
                            </a>
                        </div>
                        <div class="mt-5 space-y-4">
                            {% for mascota in mis_mascotas %}
                                <a href="{% url 'detalle_mascota' mascota.id %}" class="group flex items-center gap-4 rounded-2xl border border-[#e9ebf7] p-4 shadow-sm transition-all hover:-translate-y-0.5 hover:border-[#c7b8ff]">
                                    <div class="flex h-12 w-12 items-center justify-center rounded-full bg-[#ede9ff] text-lg font-semibold text-[#4330a0]">
                                        {{ mascota.nombre|slice:":1"|upper }}
                                    </div>
                                    <div class="flex-1">
                                        <p class="font-semibold text-[#0f172a]">{{ mascota.nombre }}</p>
                                        <p class="text-sm text-[#647093]">{{ mascota.especie }}{% if mascota.raza %} · {{ mascota.raza }}{% endif %}</p>
                                    </div>
                                    <i class="fas fa-chevron-right text-[#c3c9e6] transition-transform group-hover:translate-x-1"></i>
                                </a>
                            {% empty %}
                                <div class="rounded-2xl border border-dashed border-[#d6dbf0] bg-[#f8f9ff] p-8 text-center text-[#68719b]">
                                    <i class="fas fa-paw text-3xl"></i>
                                    <p class="mt-3 text-sm">Aún no registraste mascotas.</p>
                                    <a href="{% url 'registrar_mascota' %}" class="mt-4 inline-flex items-center gap-2 rounded-2xl bg-[#7A3AFF] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#5c25d7]">
                                        <i class="fas fa-plus"></i>
                                        Registrar primera mascota
                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                    </div>

                    <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-lg font-semibold text-[#0f172a]">Próximas citas</h3>
                                <p class="text-sm text-[#536189]">Seguimiento en tiempo real</p>
                            </div>
                            <a href="{% url 'agendar_cita' %}" class="text-sm font-semibold text-[#7A3AFF] hover:text-[#6140ff]">Nueva cita</a>
                        </div>
                        <div class="mt-6 space-y-4">
                            {% for cita in citas_proximas %}
                                <div class="rounded-2xl border border-[#e9ebf7] p-4 shadow-sm">
                                    <div class="flex items-start justify-between gap-4">
                                        <div>
                                            <p class="font-semibold text-[#0f172a]">{{ cita.paciente.nombre }}</p>
                                            <p class="text-xs text-[#647093] flex items-center gap-1">
                                                <i class="fas fa-user-md text-[#9ca4c8]"></i>
                                                {% if cita.veterinario %}
                                                    {{ cita.veterinario.get_full_name|default:cita.veterinario.username }}
                                                {% else %}
                                                    Sin veterinario asignado aún
                                                {% endif %}
                                            </p>
                                        </div>
                                        <span class="status-badge bg-[#F4F3F9] text-[#4b3b91]">{{ cita.get_estado_display }}</span>
                                    </div>
                                    <div class="mt-3 flex flex-wrap items-center gap-3 text-sm text-[#4c587a]">
                                        <span class="inline-flex items-center gap-2 font-semibold text-[#1f3b72]">
                                            <i class="fas fa-calendar"></i>
                                            {{ cita.fecha_hora|date:"d/m/Y" }}
                                        </span>
                                        <span class="inline-flex items-center gap-2">
                                            <i class="fas fa-clock"></i>
                                            {{ cita.fecha_hora|date:"H:i" }} hs
                                        </span>
                                    </div>
                                    <div class="mt-3 flex flex-wrap gap-2 text-xs font-semibold">
                                        <a href="{% url 'detalle_cita' cita.id %}" class="inline-flex items-center gap-2 rounded-full bg-[#EEF0FF] px-3 py-1 text-[#1f3b72] hover:bg-[#e0e4ff]">
                                            <i class="fas fa-eye"></i>
                                            Ver detalle
                                        </a>
                                        <a href="{% url 'detalle_mascota' cita.paciente.id %}" class="inline-flex items-center gap-2 rounded-full border border-[#c7b8ff] px-3 py-1 text-[#7A3AFF] hover:bg-[#f7f4ff]">
                                            <i class="fas fa-notes-medical"></i>
                                            Historia clínica
                                        </a>
                                    </div>
                                </div>
                            {% empty %}
                                <div class="rounded-2xl border border-dashed border-[#d6dbf0] bg-[#f8f9ff] p-8 text-center text-[#68719b]">
                                    <i class="fas fa-calendar text-3xl"></i>
                                    <p class="mt-3 text-sm">No tenés citas en agenda.</p>
                                    <a href="{% url 'agendar_cita' %}" class="mt-4 inline-flex items-center gap-2 rounded-2xl bg-[#7A3AFF] px-4 py-2 text-sm font-semibold text-white shadow hover:bg-[#5c25d7]">
                                        <i class="fas fa-calendar-plus"></i>
                                        Reservar turno
                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                    </div>

                    <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                        <h3 class="text-lg font-semibold text-[#0f172a]">Últimos informes médicos</h3>
                        <p class="mt-1 text-sm text-[#536189]">Repasá diagnósticos y recomendaciones recientes</p>
                        <div class="mt-5 space-y-4">
                            {% for historial in historiales_recientes %}
                                <div class="rounded-2xl border border-[#e9ebf7] p-4 shadow-sm">
                                    <div class="flex items-center justify-between">
                                        <p class="font-semibold text-[#0f172a]">{{ historial.paciente.nombre }}</p>
                                        <span class="text-xs font-semibold text-[#7A3AFF]">{{ historial.fecha|date:"d/m" }}</span>
                                    </div>
                                    <p class="mt-2 text-sm text-[#4c587a]">{{ historial.diagnostico|truncatechars:90 }}</p>
                                    <div class="mt-3 flex flex-wrap gap-2 text-xs font-semibold">
                                        <a href="{% url 'detalle_mascota' historial.paciente.id %}" class="inline-flex items-center gap-2 rounded-full bg-[#F4F3F9] px-3 py-1 text-[#4b3b91] hover:bg-[#ebe7ff]">
                                            <i class="fas fa-notes-medical"></i>
                                            Ver historia
                                        </a>
                                        <a href="{% url 'mis_citas' %}#historial-{{ historial.id }}" class="inline-flex items-center gap-2 rounded-full border border-[#c7b8ff] px-3 py-1 text-[#7A3AFF] hover:bg-[#f7f4ff]">
                                            <i class="fas fa-folder-open"></i>
                                            Seguimiento
                                        </a>
                                    </div>
                                </div>
                            {% empty %}
                                <div class="rounded-2xl border border-dashed border-[#d6dbf0] bg-[#f8f9ff] p-8 text-center text-[#68719b]">
                                    <i class="fas fa-file-medical text-3xl"></i>
                                    <p class="mt-3 text-sm">Cuando tengas atenciones verás aquí los informes.</p>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div>
                            <h3 class="text-lg font-semibold text-[#0f172a]">Actividad reciente</h3>
                            <p class="text-sm text-[#536189]">Últimas citas atendidas y actualizaciones</p>
                        </div>
                        <a href="{% url 'mis_citas' %}" class="inline-flex items-center gap-2 rounded-full border border-[#e0e2f3] px-4 py-1 text-xs font-semibold text-[#1f3b72] hover:border-[#c7b8ff]">
                            <i class="fas fa-list"></i>
                            Ver todo el historial
                        </a>
                    </div>
                    <div class="mt-5 space-y-4">
                        {% for cita in citas_recientes %}
                            <div class="flex flex-col gap-3 rounded-2xl border border-[#e9ebf7] p-4 shadow-sm lg:flex-row lg:items-center lg:justify-between">
                                <div>
                                    <p class="font-semibold text-[#0f172a]">{{ cita.paciente.nombre }}</p>
                                    <p class="text-sm text-[#647093]">
                                        {% if cita.fecha_hora %}
                                            {{ cita.fecha_hora|date:"d/m/Y H:i" }} hs
                                        {% else %}
                                            {{ cita.fecha_solicitada|date:"d/m/Y" }}  · Horario pendiente
                                        {% endif %}
                                    </p>
                                </div>
                                <span class="status-badge {% if cita.estado == 'atendida' %}bg-[#E6FFF4] text-[#047857]{% elif cita.estado == 'cancelada' %}bg-[#FFE8E8] text-[#B42318]{% else %}bg-[#F4F3F9] text-[#4b3b91]{% endif %}">
                                    {{ cita.get_estado_display }}
                                </span>
                                <div class="flex flex-col gap-1 text-xs text-[#5f6b8e]">
                                    <span class="inline-flex items-center gap-2">
                                        <i class="fas fa-user-md text-[#a0a8cc]"></i>
                                        {% if cita.veterinario %}
                                            {{ cita.veterinario.get_full_name|default:cita.veterinario.username }}
                                        {% else %}
                                            Veterinario por asignar
                                        {% endif %}
                                    </span>
                                    <span class="inline-flex items-center gap-2">
                                        <i class="fas fa-paw text-[#a0a8cc]"></i>
                                        {{ cita.paciente.especie }}
                                    </span>
                                </div>
                                <div class="flex flex-wrap gap-2 text-xs font-semibold">
                                    <a href="{% url 'detalle_cita' cita.id %}" class="inline-flex items-center gap-2 rounded-full bg-[#EEF0FF] px-3 py-1 text-[#1f3b72] hover:bg-[#e0e4ff]">
                                        <i class="fas fa-eye"></i>
                                        Detalles
                                    </a>
                                    {% if cita.estado == 'atendida' %}
                                        <a href="{% url 'detalle_mascota' cita.paciente.id %}" class="inline-flex items-center gap-2 rounded-full border border-[#c7b8ff] px-3 py-1 text-[#7A3AFF] hover:bg-[#f7f4ff]">
                                            <i class="fas fa-file-medical"></i>
                                            Informe
                                        </a>
                                    {% endif %}
                                </div>
                            </div>
                        {% empty %}
                            <div class="rounded-2xl border border-dashed border-[#d6dbf0] bg-[#f8f9ff] p-8 text-center text-[#68719b]">
                                <i class="fas fa-clipboard-list text-3xl"></i>
                                <p class="mt-3 text-sm">Las citas atendidas aparecerán aquí para un acceso rápido.</p>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                {% if productos_sugeridos %}
                <div class="rounded-3xl border border-[#dfe3f4] bg-white p-6 shadow-sm">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div>
                            <h3 class="text-lg font-semibold text-[#0f172a]">Recomendados para tus mascotas</h3>
                            <p class="text-sm text-[#536189]">Productos seleccionados por el equipo de Sabueso Feliz</p>
                        </div>
                        <a href="{% url 'tienda' %}" class="inline-flex items-center gap-2 rounded-full border border-[#e0e2f3] px-4 py-1 text-xs font-semibold text-[#1f3b72] hover:border-[#c7b8ff]">
                            <i class="fas fa-store"></i>
                            Ver tienda completa
                        </a>
                    </div>
                    <div class="mt-6 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4">
                        {% for producto in productos_sugeridos %}
                            <a href="{% url 'detalle_producto' producto.id %}" class="group flex flex-col overflow-hidden rounded-2xl border border-[#e9ebf7] shadow-sm transition-all hover:-translate-y-0.5 hover:border-[#c7b8ff]">
                                <div class="relative h-40 w-full bg-[#f0f1fb]">
                                    {% if producto.imagen %}
                                        <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}" class="h-full w-full object-cover">
                                    {% else %}
                                        <div class="flex h-full w-full items-center justify-center text-4xl text-[#c3c9e6]">
                                            <i class="fas fa-bone"></i>
                                        </div>
                                    {% endif %}
                                    <span class="absolute left-4 top-4 inline-flex items-center gap-1 rounded-full bg-white/90 px-3 py-1 text-xs font-semibold text-[#1f3b72] shadow">{{ producto.get_categoria_display }}</span>
                                </div>
                                <div class="flex flex-1 flex-col gap-3 p-5">
                                    <div>
                                        <h4 class="text-base font-semibold text-[#0f172a] group-hover:text-[#7A3AFF]">{{ producto.nombre }}</h4>
                                        <p class="mt-1 text-sm text-[#536189]">{{ producto.descripcion|truncatechars:70 }}</p>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-lg font-bold text-[#1f3b72]">${{ producto.precio }}</span>
                                        <span class="text-xs font-semibold text-[#047857]">
                                            {% if producto.disponible %}Disponible{% else %}Consultar{% endif %}
                                        </span>
                                    </div>
                                </div>
                            </a>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endif %}
        {% elif request.user.rol == "ADMIN_OP" %}
            <!-- Admin operator dashboard with modern design -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Panel de Operaciones</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- All Appointments -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-calendar-check mr-2 text-blue-600"></i>
                            Todas las Citas
                        </h3>
                        <div class="space-y-4 max-h-96 overflow-y-auto">
                            {% for cita in todas_citas %}
                                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                                    <div class="flex items-center space-x-2 mb-2">
                                        <i class="fas fa-paw text-green-600"></i>
                                        <span class="font-semibold text-gray-900">{{ cita.paciente.nombre }}</span>
                                    </div>
                                    <p class="text-sm text-gray-600 mb-1">
                                        <i class="fas fa-user-md mr-1"></i>
                                        {% if cita.veterinario %}
                                            {{ cita.veterinario.username }}
                                        {% else %}
                                            Sin asignar
                                        {% endif %}
                                    </p>
                                    <p class="text-sm text-gray-600">
                                        <i class="fas fa-clock mr-1"></i>
                                        {% if cita.fecha_hora %}
                                            {{ cita.fecha_hora|date:"M. d, Y, g:i a" }}
                                        {% else %}
                                            {{ cita.fecha_solicitada|date:"d/m/Y" }} · Sin horario
                                        {% endif %}
                                    </p>
                                </div>
                            {% empty %}
                                <div class="text-center py-8 text-gray-500">
                                    <i class="fas fa-calendar-times text-4xl mb-3"></i>
                                    <p>No hay citas registradas</p>
                                </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- All Patients -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-dog mr-2 text-green-600"></i>
                            Todos los Pacientes
                        </h3>
                        <div class="space-y-4 max-h-96 overflow-y-auto">
                            {% for paciente in todos_pacientes %}
                                <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors">
                                    <div class="flex items-center space-x-2 mb-1">
                                        <i class="fas fa-paw text-green-600"></i>
                                        <span class="font-semibold text-gray-900">{{ paciente.nombre }}</span>
                                    </div>
                                    <p class="text-sm text-gray-600">
                                        <i class="fas fa-user mr-1"></i>
                                        {{ paciente.propietario.user.username }}
                                    </p>
                                </div>
                            {% empty %}
                                <div class="text-center py-8 text-gray-500">
                                    <i class="fas fa-paw text-4xl mb-3"></i>
                                    <p>No hay pacientes registrados</p>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}

    <!-- Modern logout button with better styling -->
    <div class="mt-8 text-center">
        <a href="{% url 'logout' %}" class="inline-flex items-center px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors shadow-sm">
            <i class="fas fa-sign-out-alt mr-2"></i>
            Cerrar Sesion
        </a>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}{% endblock %}
