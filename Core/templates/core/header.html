{% extends "core/base.html" %}

{% block header %}
{% with current=request.resolver_match.url_name %}
<header class="bg-slate-900 text-white py-3 shadow-sm relative z-50">
    <div class="max-w-6xl mx-auto px-4 flex items-center justify-between">

        <!-- IZQUIERDA: Logo -->
        <a href="{% url 'landing' %}" class="flex items-center gap-3">
            <div class="h-9 w-9 flex items-center justify-center rounded-lg bg-white/10">
                <i class="fas fa-paw text-lg"></i>
            </div>
            <span class="text-lg font-medium tracking-tight">Sabueso Feliz</span>
        </a>

        <!-- DERECHA -->
        <div class="flex items-center gap-6 text-sm relative">

            {% if request.user.is_authenticated %}
                <span class="hidden sm:block text-white/70">
                    Hola, <strong class="text-white">{{ request.user.get_full_name|default:request.user.username }}</strong>
                </span>

                <!-- BOTÓN ABRIR SIDEBAR -->
                <button id="menuBtn" class="px-3 py-1.5 rounded-md bg-white/10 hover:bg-white/20 transition">
                    <i class="fas fa-bars"></i>
                </button>

            {% else %}
                <a href="{% url 'login' %}" class="hover:text-white">Ingresar</a>
                <a href="{% url 'registro_propietario' %}" class="px-3 py-1.5 rounded-md bg-white text-slate-900 font-medium hover:bg-slate-100 transition">Registrarme</a>
            {% endif %}

        </div>
    </div>
</header>

<!-- ========================= -->
<!--      SIDEBAR DERECHA      -->
<!-- ========================= -->
<div id="sidebar"
     class="fixed top-0 right-0 h-full w-64 bg-slate-800 text-white shadow-xl transform translate-x-full transition-transform duration-300 z-[9999]">

    <!-- HEADER -->
    <div class="px-5 py-4 border-b border-white/10 flex items-center justify-between">
        <span class="text-lg font-medium">Menú</span>

        <button id="closeSidebar" class="text-white/70 hover:text-white">
            <i class="fas fa-times text-xl"></i>
        </button>
    </div>

    <!-- MENÚ -->
    <nav class="px-4 py-4 space-y-1 text-sm">

        {% if request.user.rol == "ADMIN" or request.user.rol == "ADMIN_OP" %}
            <a href="{% url 'listar_usuarios' %}" class="sidebar-item">Usuarios</a>
            <a href="{% url 'listar_pacientes' %}" class="sidebar-item">Pacientes</a>
            <a href="{% url 'dashboard' %}" class="sidebar-item">Panel</a>
        {% endif %}

        {% if request.user.rol == "VET" %}
            <a href="{% url 'mis_citas' %}" class="sidebar-item">Mis Citas</a>
            <a href="{% url 'historial_medico_vet' %}" class="sidebar-item">Historial Médico</a>
        {% endif %}

        {% if request.user.rol == "OWNER" %}
            <a href="{% url 'mis_mascotas' %}" class="sidebar-item">Mis Mascotas</a>
            <a href="{% url 'mis_citas' %}" class="sidebar-item">Mis Citas</a>
        {% endif %}

        <hr class="border-white/10 my-3">

        <a href="{% url 'logout' %}" class="sidebar-item text-red-300 hover:text-red-400">Salir</a>

    </nav>
</div>

<style>
.sidebar-item {
    display: block;
    padding: 10px 12px;
    border-radius: 6px;
    color: #e2e8f0;
}
.sidebar-item:hover {
    background: rgba(255, 255, 255, 0.08);
}
</style>

<script>
const sidebar = document.getElementById("sidebar");
const openBtn = document.getElementById("menuBtn");
const closeBtn = document.getElementById("closeSidebar");

if (openBtn) {
    openBtn.addEventListener("click", () => {
        sidebar.classList.remove("translate-x-full");
    });
}

if (closeBtn) {
    closeBtn.addEventListener("click", () => {
        sidebar.classList.add("translate-x-full");
    });
}
</script>

{% endwith %}
{% endblock %}
