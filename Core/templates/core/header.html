{% extends "core/base.html" %}

{% block header %}
{% with current=request.resolver_match.url_name %}
<header class="bg-slate-900 text-white py-3 shadow-sm relative z-50">
    <div class="max-w-6xl mx-auto px-4 flex items-center justify-between">

        <!-- IZQUIERDA: Logo + Marca -->
        <a href="{% url 'landing' %}" class="flex items-center gap-3">
            <div class="h-9 w-9 flex items-center justify-center rounded-lg bg-white/10">
                <i class="fas fa-paw text-lg"></i>
            </div>
            <span class="text-lg font-medium tracking-tight">Sabueso Feliz</span>
        </a>

        <!-- DERECHA: Bienvenida + Menú -->
        <div class="flex items-center gap-6 text-sm relative">

            {% if request.user.is_authenticated %}
                <span class="hidden sm:block text-white/70">
                    Hola, <strong class="text-white">{{ request.user.get_full_name|default:request.user.username }}</strong>
                </span>

                <!-- BOTÓN MENÚ -->
                <button id="menuBtn" class="px-3 py-1.5 rounded-md bg-white/10 hover:bg-white/20 transition">
                    <i class="fas fa-bars"></i>
                </button>

                <!-- DROPDOWN -->
                <div id="dropdownMenu" class="hidden absolute right-0 top-12 bg-slate-800 text-white rounded-md shadow-lg w-44 py-2 z-[9999]">

                    <!-- Enlaces según rol -->
                    {% if request.user.rol == "ADMIN" or request.user.rol == "ADMIN_OP" %}
                        <a href="{% url 'listar_usuarios' %}" class="dropdown-item">Usuarios</a>
                        <a href="{% url 'listar_pacientes' %}" class="dropdown-item">Pacientes</a>
                        <a href="{% url 'dashboard' %}" class="dropdown-item">Panel</a>
                    {% endif %}

                    {% if request.user.rol == "VET" %}
                        <a href="{% url 'mis_citas' %}" class="dropdown-item">Mis Citas</a>
                        <a href="{% url 'historial_medico_vet' %}" class="dropdown-item">Historial</a>
                    {% endif %}

                    {% if request.user.rol == "OWNER" %}
                        <a href="{% url 'mis_mascotas' %}" class="dropdown-item">Mis Mascotas</a>
                        <a href="{% url 'mis_citas' %}" class="dropdown-item">Mis Citas</a>
                    {% endif %}

                    <hr class="border-white/10 my-2">

                    <a href="{% url 'logout' %}" class="dropdown-item text-red-300 hover:text-red-400">Salir</a>
                </div>

            {% else %}
                <a href="{% url 'login' %}" class="hover:text-white">Ingresar</a>
                <a href="{% url 'registro_propietario' %}" class="px-3 py-1.5 rounded-md bg-white text-slate-900 font-medium hover:bg-slate-100 transition">Registrarme</a>
            {% endif %}

        </div>
    </div>
</header>

<style>
.dropdown-item {
    display: block;
    padding: 8px 14px;
    font-size: 0.875rem;
    color: #e2e8f0;
}
.dropdown-item:hover {
    background: rgba(255,255,255,0.08);
}
</style>

<script>
document.getElementById("menuBtn").addEventListener("click", () => {
    document.getElementById("dropdownMenu").classList.toggle("hidden");
});
</script>

{% endwith %}
{% endblock %}